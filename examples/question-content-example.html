<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questionaire Question with Content Example</title>
    <script type="importmap">
    {
      "imports": {
        "lit": "https://unpkg.com/lit@3.3.1/index.js",
        "lit/": "https://unpkg.com/lit@3.3.1/",
        "@lit/reactive-element": "https://unpkg.com/@lit/reactive-element@2.1.1/reactive-element.js",
        "@lit/reactive-element/": "https://unpkg.com/@lit/reactive-element@2.1.1/",
        "lit-html": "https://unpkg.com/lit-html@3.3.1/lit-html.js",
        "lit-html/": "https://unpkg.com/lit-html@3.3.1/",
        "lit-element": "https://unpkg.com/lit-element@4.2.1/lit-element.js",
        "lit-element/": "https://unpkg.com/lit-element@4.2.1/"
      }
    }
    </script>
    <script type="module" src="../src/questionaire-question-answer.js"></script>
    <script type="module" src="../src/questionaire-question.js"></script>
    <script type="module" src="../src/questionaire-question-content.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        .example-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .example-section h3 {
            margin-top: 0;
        }
        questionaire-question {
            display: block;
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #007bff;
            border-radius: 8px;
            background-color: white;
        }
        questionaire-question-content {
            display: block;
            margin-bottom: 15px;
            padding: 10px;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
        }
        questionaire-question-answer {
            display: block;
            margin: 10px 0;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        questionaire-question-answer:hover {
            border-color: #007bff;
            background-color: #f0f8ff;
        }
        questionaire-question-answer[selected] {
            border-color: #28a745;
            background-color: #d4edda;
        }
        .controls {
            margin: 20px 0;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
        }
        button {
            margin: 5px;
            padding: 8px 16px;
            border: 1px solid #ccc;
            border-radius: 3px;
            background-color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #f8f9fa;
        }
        .info-panel {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Questionaire Question with Content Example</h1>
    
    <div class="example-section">
        <h3>Question with Content and Single-Select Answers</h3>
        <p>This demonstrates a question with content (question text) and answer options.</p>
        
        <questionaire-question id="content-single-question">
            <questionaire-question-content>
                How often do you go to the gym?
            </questionaire-question-content>
            <questionaire-question-answer value="never">
                Never
            </questionaire-question-answer>
            <questionaire-question-answer value="year">
                Once or more per year
            </questionaire-question-answer>
            <questionaire-question-answer value="month">
                Once or more per month
            </questionaire-question-answer>
            <questionaire-question-answer value="week">
                Once or more per week
            </questionaire-question-answer>
        </questionaire-question>
    </div>

    <div class="example-section">
        <h3>Question with Content and Multi-Select Answers</h3>
        <p>This demonstrates a question with content and multiple selectable answers.</p>
        
        <questionaire-question id="content-multi-question" multiselect>
            <questionaire-question-content>
                <strong>What types of exercise do you enjoy?</strong>
                <br><em>Select all that apply:</em>
            </questionaire-question-content>
            <questionaire-question-answer value="cardio">
                Cardio exercises (running, cycling, swimming)
            </questionaire-question-answer>
            <questionaire-question-answer value="strength">
                Strength training (weights, resistance)
            </questionaire-question-answer>
            <questionaire-question-answer value="flexibility">
                Flexibility/Stretching (yoga, pilates)
            </questionaire-question-answer>
            <questionaire-question-answer value="sports">
                Sports activities (tennis, basketball, etc.)
            </questionaire-question-answer>
        </questionaire-question>
    </div>

    <div class="example-section">
        <h3>Question with Multiple Content Elements</h3>
        <p>This demonstrates a question with multiple content sections.</p>
        
        <questionaire-question id="multi-content-question">
            <questionaire-question-content>
                <h4>Exercise Frequency Assessment</h4>
            </questionaire-question-content>
            <questionaire-question-content>
                Please consider your typical weekly exercise routine when answering this question.
            </questionaire-question-content>
            <questionaire-question-content>
                <strong>How many days per week do you exercise?</strong>
            </questionaire-question-content>
            <questionaire-question-answer value="0">
                0 days (I don't exercise regularly)
            </questionaire-question-answer>
            <questionaire-question-answer value="1-2">
                1-2 days per week
            </questionaire-question-answer>
            <questionaire-question-answer value="3-4">
                3-4 days per week
            </questionaire-question-answer>
            <questionaire-question-answer value="5+">
                5 or more days per week
            </questionaire-question-answer>
        </questionaire-question>
    </div>

    <div class="controls">
        <h3>Controls</h3>
        <button onclick="getQuestionValues()">Get Question Values</button>
        <button onclick="clearSelections()">Clear All Selections</button>
        <button onclick="testProgrammatic()">Test Programmatic Selection</button>
        <button onclick="testEvents()">Test Event Dispatching</button>
    </div>

    <div class="info-panel" id="info">
        Click "Get Question Values" to see current question values
    </div>

    <script>
        let eventLog = [];

        function getQuestionValues() {
            const contentSingleQuestion = document.getElementById('content-single-question');
            const contentMultiQuestion = document.getElementById('content-multi-question');
            const multiContentQuestion = document.getElementById('multi-content-question');
            
            let info = 'Question Values:\n\n';
            info += `Content single-select question value: ${JSON.stringify(contentSingleQuestion.value)}\n`;
            info += `Content multi-select question value: ${JSON.stringify(contentMultiQuestion.value)}\n`;
            info += `Multi-content question value: ${JSON.stringify(multiContentQuestion.value)}\n\n`;
            
            info += 'Content Elements Check:\n';
            const contentElements1 = contentSingleQuestion.querySelectorAll('questionaire-question-content');
            const contentElements2 = contentMultiQuestion.querySelectorAll('questionaire-question-content');
            const contentElements3 = multiContentQuestion.querySelectorAll('questionaire-question-content');
            
            info += `Question 1 has ${contentElements1.length} content element(s)\n`;
            info += `Question 2 has ${contentElements2.length} content element(s)\n`;
            info += `Question 3 has ${contentElements3.length} content element(s)\n\n`;
            
            info += 'Event Log:\n';
            eventLog.forEach((event, index) => {
                info += `${index + 1}. ${event}\n`;
            });
            
            document.getElementById('info').textContent = info;
        }

        function clearSelections() {
            document.querySelectorAll('questionaire-question-answer').forEach(answer => {
                answer.removeAttribute('selected');
            });
            eventLog.push('Cleared all selections');
            getQuestionValues();
        }

        function testProgrammatic() {
            // Test programmatic selection on content single-select
            const contentSingleAnswers = document.querySelectorAll('#content-single-question questionaire-question-answer');
            if (contentSingleAnswers.length > 0) {
                contentSingleAnswers[1].selected = true; // Select second answer
            }
            
            // Test programmatic selection on content multi-select
            const contentMultiAnswers = document.querySelectorAll('#content-multi-question questionaire-question-answer');
            if (contentMultiAnswers.length > 1) {
                contentMultiAnswers[0].selected = true;
                contentMultiAnswers[2].selected = true;
            }
            
            eventLog.push('Set programmatic selections on content questions');
            getQuestionValues();
        }

        function testEvents() {
            eventLog = []; // Clear event log
            
            // Simulate click on content single-select answer
            const contentSingleAnswer = document.querySelector('#content-single-question questionaire-question-answer');
            if (contentSingleAnswer) {
                contentSingleAnswer.click();
            }
            
            getQuestionValues();
        }

        // Listen for selection changes to log events and update values
        document.addEventListener('DOMContentLoaded', () => {
            // Use MutationObserver to detect selection changes
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'selected') {
                        const answer = mutation.target;
                        eventLog.push(`Answer selection changed: ${answer.value || answer.textContent.trim()}`);
                        getQuestionValues();
                    }
                });
            });

            // Observe all answer elements for selection changes
            document.querySelectorAll('questionaire-question-answer').forEach(answer => {
                observer.observe(answer, { attributes: true, attributeFilter: ['selected'] });
            });

            // Listen for question:changed events
            document.querySelectorAll('questionaire-question').forEach(question => {
                question.addEventListener('question:changed', (event) => {
                    const answerElement = event.detail.element;
                    const answerValue = answerElement.value || answerElement.textContent.trim();
                    eventLog.push(`question:changed event - Answer: ${answerValue}, Selected: ${answerElement.selected}`);
                });
            });
            
            // Initial state
            getQuestionValues();
        });
    </script>
</body>
</html>